#include "SharewareFlags.h"#if NEED_PROGRESS_BAR#include "ProgressBar.h"ProgressBar::ProgressBar(short dlogID, short index, long size){	max = size;	aktval = value = 0L;	dp = ::GetNewDialog(dlogID, nil, (DialogPtr)-1L);	if(!dp) return;	// Titeltext setzen	short itemType; Rect box; Handle item;	Str255	text;	::GetIndString(text, 1000, index);	::GetDialogItem(dp, 2, &itemType, &item, &box);	::SetDialogItemText(item, text);	::ShowWindow(dp);	::DrawDialog(dp);}void	ProgressBar::SetInfo(ConstStr255Param inStr){	short itemType; Rect box; Handle item;	::GetDialogItem(dp, 3, &itemType, &item, &box);	::SetDialogItemText(item, inStr);}void	ProgressBar::Update(){	if(!dp) return;	// im Wertebereich halten	if(value > max) value = max;	if(value < 0) value = 0;	// Progressbar verŠndert? Nein => raus	if(value == aktval) return;	aktval = value;	short	pgbVal = double(value) / max * 10000;	// Progressbar neu setzen	short itemType; Rect box; ControlRef theControl;	::GetDialogItem(dp, 1, &itemType, &(Handle)theControl, &box);	::SetControlValue(theControl, pgbVal);}#endif